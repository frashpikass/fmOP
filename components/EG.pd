#N canvas 119 18 1528 933 10;
#X obj 921 41 cnv 15 216 79 empty empty Velocity\ test 20 12 0 14 -262113
-258049 0;
#X obj 601 762 cnv 15 231 59 empty empty Out:\ LR4\ volume\ envelope
20 12 0 14 -135137 -66577 0;
#X obj 1145 41 cnv 15 181 58 empty empty IN:\ note\ velocity 20 12
0 14 -135137 -66577 0;
#X obj 1084 261 cnv 15 366 367 empty empty Release 20 12 0 14 -260129
-4033 0;
#X obj 11 261 cnv 15 1059 367 empty empty Attack\ Decay\ Sustain 20
12 0 14 -260129 -4033 0;
#X obj 357 41 cnv 15 551 214 empty empty Velocity\ handling 20 12 0
14 -233017 -2049 0;
#X obj 96 93 cnv 15 194 160 empty empty LR4\ ENVELOPE\ GENERATOR 20
12 0 12 -260928 -258112 0;
#X floatatom 144 140 5 0 99 0 L1 #1-EG_L1.r #1-EG_L1.s, f 5;
#X floatatom 144 161 5 0 99 0 L2 #1-EG_L2.r #1-EG_L2.s, f 5;
#X floatatom 144 182 5 0 99 0 L3 #1-EG_L3.r #1-EG_L3.s, f 5;
#X floatatom 144 203 5 0 99 0 L4 #1-EG_L4.r #1-EG_L4.s, f 5;
#X floatatom 226 140 5 0 99 0 R1 #1-EG_R1.r #1-EG_R1.s, f 5;
#X floatatom 226 161 5 0 99 0 R2 #1-EG_R2.r #1-EG_R2.s, f 5;
#X floatatom 226 182 5 0 99 0 R3 #1-EG_R3.r #1-EG_R3.s, f 5;
#X floatatom 226 203 5 0 99 0 R4 #1-EG_R4.r #1-EG_R4.s, f 5;
#X text 144 118 LEVELS;
#X text 209 118 RANGES;
#X obj 1152 74 inlet;
#X obj 1152 108 select 0;
#X text 99 504 Level 1;
#X text 433 505 Level 2;
#X text 771 504 Level 3;
#X msg 941 66 0;
#X msg 982 66 1;
#X msg 1023 66 32;
#X msg 1064 66 64;
#X msg 1105 66 127;
#X text 945 97 Test values for note velocity;
#X floatatom 189 482 10 0 0 0 - - -, f 10;
#X obj 66 598 pack f f 0;
#X obj 656 685 vline~;
#X obj 400 599 pack f f 0;
#X floatatom 523 482 10 0 0 0 - - -, f 10;
#X obj 738 599 pack f f 0;
#X floatatom 861 482 10 0 0 0 - - -, f 10;
#X obj 706 572 +;
#X obj 369 295 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 1116 319 t b b;
#X obj 1116 599 pack f f 0;
#X floatatom 1239 482 10 0 0 0 - - -, f 10;
#X text 1149 504 Level 4;
#X msg 1143 376 stop;
#X obj 1116 295 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X floatatom 66 503 5 0 0 0 - - -, f 5;
#X floatatom 400 504 5 0 0 0 - - -, f 5;
#X floatatom 738 504 5 0 0 0 - - -, f 5;
#X text 1099 393 Clear line commands;
#X msg 432 376 stop;
#X text 388 393 Clear line commands;
#X obj 369 319 t b b b b b;
#X floatatom 1116 504 5 0 0 0 - - -, f 5;
#X floatatom 715 227 5 0 0 0 - - -, f 5;
#X text 428 128 min velocity;
#X text 557 128 max velocity;
#X text 523 63 This section makes sure that every note velocity is
within a specific range. It outputs the scale factor for peak level
as a function of note velocity.;
#X text 685 128 max velocity (MIDI);
#X obj 656 128 127;
#X text 754 227 Scale factor;
#X obj 66 482 expr ($f2*$f3)/100;
#X obj 400 482 expr ($f2*$f3)/100;
#X obj 738 482 expr ($f2*$f3)/100;
#X obj 1116 482 expr ($f2*$f3)/100;
#X obj 735 151 tgl 15 0 empty \$1-EG_use_velocity.s Scale\ with\ note\ velocity
17 7 0 10 -262144 -1 -1 0 1;
#X obj 384 183 expr (((($f1<=$f2) * $f2) + ((($f1>$f2)&&($f1<=$f3))
* $f1) + (($f1>$f3) * $f3)) / $f4) * $f5 + ($f5==0)*1;
#X text 253 482 mseconds to change;
#X text 585 482 mseconds to change;
#X text 925 482 mseconds to change;
#X text 1302 482 mseconds to change;
#X obj 144 229 tgl 15 0 \$1-EG_use_velocity.s \$1-EG_use_velocity.r
Use\ MIDI\ velocity 17 7 0 10 -262144 -1 -1 0 1;
#X obj 369 96 t b f b b b;
#X obj 403 128 40;
#X obj 528 128 100;
#X obj 656 789 outlet~;
#X text 86 76 External view of control panel;
#X text 677 700 Envelope (ramp) generator;
#X obj 1202 550 tools/testOutput;
#X obj 1031 152 loadbang;
#X obj 1031 174 f \$0;
#X floatatom 1031 196 5 0 0 0 - - -, f 5;
#X text 935 196 Abstraction ID:;
#X obj 91 455 r \$1-EG_L1.s;
#X obj 189 404 r \$1-EG_R1.s;
#X obj 189 431 EGrate \$1-EG_L4.s \$1-EG_L1.s \$1-EG_R1.s;
#X obj 436 455 r \$1-EG_L2.s;
#X obj 523 431 EGrate \$1-EG_L1.s \$1-EG_L2.s \$1-EG_R2.s;
#X obj 765 455 r \$1-EG_L3.s;
#X obj 827 431 EGrate \$1-EG_L2.s \$1-EG_L3.s \$1-EG_R3.s;
#X obj 1140 455 r \$1-EG_L4.s;
#X obj 1203 431 EGrate \$1-EG_L3.s \$1-EG_L4.s \$1-EG_R4.s;
#X text 17 2 EG.pd;
#X text 17 15 An LR4 envelope generator using 4 levels \, 4 variation
rates and MIDI velocity.;
#X text 17 41 (C) 2017 Frash Pikass;
#X connect 17 0 18 0;
#X connect 18 0 42 0;
#X connect 18 1 69 0;
#X connect 22 0 18 0;
#X connect 23 0 18 0;
#X connect 24 0 18 0;
#X connect 25 0 18 0;
#X connect 26 0 18 0;
#X connect 28 0 31 2;
#X connect 28 0 29 1;
#X connect 28 0 35 0;
#X connect 29 0 30 0;
#X connect 30 0 72 0;
#X connect 30 0 75 0;
#X connect 31 0 30 0;
#X connect 32 0 31 1;
#X connect 32 0 35 1;
#X connect 33 0 30 0;
#X connect 34 0 33 1;
#X connect 35 0 33 2;
#X connect 36 0 49 0;
#X connect 37 0 61 0;
#X connect 37 1 41 0;
#X connect 38 0 30 0;
#X connect 39 0 38 1;
#X connect 41 0 30 0;
#X connect 42 0 37 0;
#X connect 47 0 30 0;
#X connect 49 0 60 0;
#X connect 49 1 35 0;
#X connect 49 2 59 0;
#X connect 49 3 58 0;
#X connect 49 4 47 0;
#X connect 56 0 63 3;
#X connect 58 0 29 0;
#X connect 58 0 43 0;
#X connect 59 0 31 0;
#X connect 59 0 44 0;
#X connect 60 0 33 0;
#X connect 60 0 45 0;
#X connect 61 0 38 0;
#X connect 61 0 50 0;
#X connect 62 0 63 4;
#X connect 63 0 51 0;
#X connect 63 0 58 2;
#X connect 63 0 59 2;
#X connect 63 0 60 2;
#X connect 63 0 61 2;
#X connect 69 0 36 0;
#X connect 69 1 63 0;
#X connect 69 2 70 0;
#X connect 69 3 71 0;
#X connect 69 4 56 0;
#X connect 70 0 63 1;
#X connect 71 0 63 2;
#X connect 76 0 77 0;
#X connect 77 0 78 0;
#X connect 80 0 58 1;
#X connect 81 0 82 0;
#X connect 82 0 28 0;
#X connect 83 0 59 1;
#X connect 84 0 32 0;
#X connect 85 0 60 1;
#X connect 86 0 34 0;
#X connect 87 0 61 1;
#X connect 88 0 39 0;
#X coords 0 -1 1 1 194 160 2 96 93;
